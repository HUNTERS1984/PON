services:
    pon.manager.facebook:
        class: Facebook\Facebook
        arguments: ["%facebook_config%"]

    pon.manager.twitter:
        class: Abraham\TwitterOAuth\TwitterOAuth
        arguments: ["%twitter_consumer_key%", "%twitter_consumer_secret%"]

    pon.manager.app_user:
        class: CoreBundle\Manager\AppUserManager
        factory_service:  doctrine
        factory_method:   getEntityManager
        arguments: ["@doctrine.orm.entity_manager", "CoreBundle\\Entity\\AppUser"]
        calls:
            - [setPagination, ["@pon.paginator.pagination"]]
            - [setFacebookManager, ["@pon.manager.facebook"]]
            - [setTwitterManager, ["@pon.manager.twitter"]]
            - [setAppUserFinder, ["@fos_elastica.finder.app.appUser"]]

    pon.manager.client:
        class: CoreBundle\Manager\ClientManager
        factory_service:  doctrine
        factory_method:   getEntityManager
        arguments: ["@doctrine.orm.entity_manager", "CoreBundle\\Entity\\Client"]

    pon.manager.use_list:
        class: CoreBundle\Manager\UseListManager
        factory_service:  doctrine
        factory_method:   getEntityManager
        arguments: ["@doctrine.orm.entity_manager", "CoreBundle\\Entity\\UseList"]
        calls:
            - [setPagination, ["@pon.paginator.pagination"]]
            - [setUseListFinder, ["@fos_elastica.finder.app.useList"]]

    pon.manager.follow_list:
        class: CoreBundle\Manager\FollowListManager
        factory_service:  doctrine
        factory_method:   getEntityManager
        arguments: ["@doctrine.orm.entity_manager", "CoreBundle\\Entity\\FollowList"]
        calls:
            - [setPagination, ["@pon.paginator.pagination"]]
            - [setFollowListFinder, ["@fos_elastica.finder.app.followList"]]

    pon.manager.like_list:
        class: CoreBundle\Manager\LikeListManager
        factory_service:  doctrine
        factory_method:   getEntityManager
        arguments: ["@doctrine.orm.entity_manager", "CoreBundle\\Entity\\LikeList"]
        calls:
            - [setPagination, ["@pon.paginator.pagination"]]
            - [setLikeListFinder, ["@fos_elastica.finder.app.likeList"]]

    pon.manager.store_type:
        class: CoreBundle\Manager\StoreTypeManager
        factory_service:  doctrine
        factory_method:   getEntityManager
        arguments: ["@doctrine.orm.entity_manager", "CoreBundle\\Entity\\StoreType"]
        calls:
            - [setPagination, ["@pon.paginator.pagination"]]

    pon.manager.store:
        class: CoreBundle\Manager\StoreManager
        factory_service:  doctrine
        factory_method:   getEntityManager
        arguments: ["@doctrine.orm.entity_manager", "CoreBundle\\Entity\\Store"]
        calls:
            - [setPagination, ["@pon.paginator.pagination"]]
            - [setStoreFinder, ["@fos_elastica.finder.app.store"]]

    pon.manager.category:
        class: CoreBundle\Manager\CategoryManager
        factory_service:  doctrine
        factory_method:   getEntityManager
        arguments: ["@doctrine.orm.entity_manager", "CoreBundle\\Entity\\Category"]
        calls:
            - [setPagination, ["@pon.paginator.pagination"]]
            - [setCategoryFinder, ["@fos_elastica.finder.app.category"]]

    pon.manager.coupon_photo:
        class: CoreBundle\Manager\CouponPhotoManager
        factory_service:  doctrine
        factory_method:   getEntityManager
        arguments: ["@doctrine.orm.entity_manager", "CoreBundle\\Entity\\CouponPhoto"]

    pon.manager.store_photo:
        class: CoreBundle\Manager\StorePhotoManager
        factory_service:  doctrine
        factory_method:   getEntityManager
        arguments: ["@doctrine.orm.entity_manager", "CoreBundle\\Entity\\StorePhoto"]

    pon.manager.coupon_user_photo:
        class: CoreBundle\Manager\CouponUserPhotoManager
        factory_service:  doctrine
        factory_method:   getEntityManager
        arguments: ["@doctrine.orm.entity_manager", "CoreBundle\\Entity\\CouponUserPhoto"]

    pon.manager.coupon:
        class: CoreBundle\Manager\CouponManager
        factory_service:  doctrine
        factory_method:   getEntityManager
        arguments: ["@doctrine.orm.entity_manager", "CoreBundle\\Entity\\Coupon"]
        calls:
            - [setPagination, ["@pon.paginator.pagination"]]
            - [setCouponFinder, ["@fos_elastica.finder.app.coupon"]]
            - [setCategoryFinder, ["@fos_elastica.finder.app.category"]]
            - [setCategoryManager, ["@pon.manager.category"]]
            - [setUseListFinder, ["@fos_elastica.finder.app.useList"]]
            - [setAvatarDir, ["%coupon_avatar_path%"]]
            - [setImageDir, ["%image_path%"]]

    pon.manager.photo:
        class: CoreBundle\Manager\PhotoManager
        factory_service:  doctrine
        factory_method:   getEntityManager
        arguments: ["@doctrine.orm.entity_manager", "CoreBundle\\Entity\\Photo"]

    pon.manager.post:
        class: CoreBundle\Manager\PostManager
        factory_service:  doctrine
        factory_method:   getEntityManager
        arguments: ["@doctrine.orm.entity_manager", "CoreBundle\\Entity\\Post"]
        calls:
            - [setPagination, ["@pon.paginator.pagination"]]

    pon.manager.news:
        class: CoreBundle\Manager\NewsManager
        factory_service:  doctrine
        factory_method:   getEntityManager
        arguments: ["@doctrine.orm.entity_manager", "CoreBundle\\Entity\\News"]
        calls:
            - [setPagination, ["@pon.paginator.pagination"]]

    pon.dummy.client:
        class: CoreBundle\DummyData\ClientDummy
        calls:
            - [setManager, ["@pon.manager.client"]]

    pon.dummy.app_user:
        class: CoreBundle\DummyData\AppUserDummy
        calls:
            - [setManager, ["@pon.manager.app_user"]]

    pon.dummy.use_list:
        class: CoreBundle\DummyData\UseCouponDummy
        calls:
            - [setManager, ["@pon.manager.coupon"]]
            - [setAppUserManager, ["@pon.manager.app_user"]]
            - [setUseListManager, ["@pon.manager.use_list"]]
    pon.dummy.category:
        class: CoreBundle\DummyData\CategoryDummy
        calls:
            - [setManager, ["@pon.manager.category"]]
            - [setAvatarDirPath, ["%category_avatar_path%"]]
    pon.dummy.store:
        class: CoreBundle\DummyData\StoreDummy
        calls:
            - [setManager, ["@pon.manager.store"]]
            - [setCategoryManager, ["@pon.manager.category"]]
            - [setAppUserManager, ["@pon.manager.app_user"]]
            - [setPhotoManager, ["@pon.manager.photo"]]
            - [setAvatarDirPath, ["%store_avatar_path%"]]
            - [setImageDirPath, ["%image_path%"]]
            - [setStorePhotoManager, ["@pon.manager.store_photo"]]

    pon.dummy.coupon:
        class: CoreBundle\DummyData\CouponDummy
        calls:
            - [setManager, ["@pon.manager.coupon"]]
            - [setStoreManager, ["@pon.manager.store"]]
            - [setPhotoManager, ["@pon.manager.photo"]]
            - [setAvatarDirPath, ["%coupon_avatar_path%"]]
            - [setImageDirPath, ["%image_path%"]]
            - [setCouponPhotoManager, ["@pon.manager.coupon_photo"]]
            - [setCouponUserPhotoManager, ["@pon.manager.coupon_user_photo"]]

    pon.exception.exception_handler:
        class: CoreBundle\Exception\ExceptionHandler
        arguments: ["@validator", "@translator"]

    pon.utils.data:
        class: CoreBundle\Utils\Data

    pon.serializator.serializer:
        class: CoreBundle\Serializator\Serializer
        arguments: ["@serializer"]

    pon.paginator.pagination:
        class: CoreBundle\Paginator\Pagination

    pon.queue.consumer.scrapping:
            class: CoreBundle\Queue\Consumer\ScrappingConsumer

    pon.queue.producer.scrapping:
        class: CoreBundle\Queue\Producer\DelayedProducer
        arguments:
            - "@old_sound_rabbit_mq.connection.default"
            - expire_offer
            - delay

    pon.listener.serialize:
        class: CoreBundle\EventListener\SerializeListener
        calls:
            - [setSecurityContext, ["@security.token_storage"]]
            - [setStoreManager, ["@pon.manager.store"]]
            - [setCouponManager, ["@pon.manager.coupon"]]
            - [setAppUserManager, ["@pon.manager.app_user"]]
            - [setCouponTypes, ["%coupon_types%"]]
            - [setUseListManager, ["@pon.manager.use_list"]]
            - [setLikeListManager, ["@pon.manager.like_list"]]
            - [setFollowListManager, ["@pon.manager.follow_list"]]
            - [setRouter, ["@router"]]
            - [setRequest, ["@request_stack"]]
            - [setBaseCouponAvatarPath,["%base_coupon_avatar_path%"]]
            - [setBaseStoreAvatarPath,["%base_store_avatar_path%"]]
            - [setBaseCategoryAvatarPath,["%base_category_avatar_path%"]]
            - [setBaseImagePath,["%base_image_upload%"]]
        tags:
            - { name: jms_serializer.event_subscriber}

    pon.listener.elastica.coupon:
        class: CoreBundle\EventListener\ElasticaCouponListener
        calls:
            - [setObjectPersisterCoupon, ["@fos_elastica.object_persister.app.coupon"]]
            - [setObjectPersisterCategory, ["@fos_elastica.object_persister.app.category"]]
        tags:
            - { name: doctrine.event_subscriber}

    pon.listener.custom.property.coupon:
        class: CoreBundle\EventListener\ElasticaCustomCouponListener
        calls:
            - [setCouponManager, ["@pon.manager.coupon"]]
        tags:
            - { name: kernel.event_subscriber }